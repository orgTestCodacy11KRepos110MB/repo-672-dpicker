!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.DPicker=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function nanomorph(e,o){assert.equal(typeof e,"object","nanomorph: oldTree should be an object"),assert.equal(typeof o,"object","nanomorph: newTree should be an object");var a=walk(o,e);return a}function walk(e,o){return o?e?e.isSameNode&&e.isSameNode(o)?o:e.tagName!==o.tagName?e:(morph(e,o),updateChildren(e,o),o):null:e}function updateChildren(e,o){if(e.childNodes&&o.childNodes)for(var a=e.childNodes.length,r=o.childNodes.length,d=Math.max(r,a),l=0,n=0,h=0;h<d;h++,l++,n++){var t=e.childNodes[l],i=o.childNodes[n],s=walk(t,i);s?i?s!==i&&(o.replaceChild(s,i),l--):s&&(o.appendChild(s),l--):i&&(o.removeChild(i),n--)}}var morph=require("./lib/morph");module.exports=nanomorph},{"./lib/morph":3}],2:[function(require,module,exports){module.exports=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","ondragstart","ondrag","ondragenter","ondragleave","ondragover","ondrop","ondragend","onkeydown","onkeypress","onkeyup","onunload","onabort","onerror","onresize","onscroll","onselect","onchange","onsubmit","onreset","onfocus","onblur","oninput","oncontextmenu","onfocusin","onfocusout"]},{}],3:[function(require,module,exports){function morph(e,t){var u=e.nodeType,l=e.nodeName;u===ELEMENT_NODE&&copyAttrs(e,t),u!==TEXT_NODE&&u!==COMMENT_NODE||(t.nodeValue=e.nodeValue),"INPUT"===l?updateInput(e,t):"OPTION"===l?updateOption(e,t):"TEXTAREA"===l?updateTextarea(e,t):"SELECT"===l&&updateSelect(e,t),copyEvents(e,t)}function copyAttrs(e,t){for(var u=t.attributes,l=e.attributes,a=null,n=null,r=null,i=null,d=null,o=l.length-1;o>=0;--o)d=l[o],i=d.name,a=d.namespaceURI,n=d.value,a?(i=d.localName||i,r=t.getAttributeNS(a,i),r!==n&&t.setAttributeNS(a,i,n)):(r=t.getAttribute(i),r!==n&&("null"===n||"undefined"===n?t.removeAttribute(i):t.setAttribute(i,n)));for(var s=u.length-1;s>=0;--s)d=u[s],d.specified!==!1&&(i=d.name,a=d.namespaceURI,a?(i=d.localName||i,e.hasAttributeNS(a,i)||t.removeAttributeNS(a,i)):e.hasAttributeNS(null,i)||t.removeAttribute(i))}function copyEvents(e,t){for(var u=0;u<eventsLength;u++){var l=events[u];e[l]?t[l]=e[l]:t[l]&&(t[l]=void 0)}}function updateOption(e,t){updateAttribute(e,t,"selected")}function updateInput(e,t){var u=e.value,l=t.value;updateAttribute(e,t,"checked"),updateAttribute(e,t,"disabled"),e.hasAttributeNS(null,"value")&&"null"!==u?u!==l?(t.setAttribute("value",u),t.value=u):t.value=u:(t.value="",t.removeAttribute("value"))}function updateTextarea(e,t){var u=e.value;if(u!==t.value&&(t.value=u),t.firstChild){if(""===u&&t.firstChild.nodeValue===t.placeholder)return;t.firstChild.nodeValue=u}}function updateSelect(e,t){if(!t.hasAttributeNS(null,"multiple")){for(var u=e.firstChild,l=0;u;){var a=u.nodeName;if(a&&"OPTION"===a.toUpperCase()){if(u.hasAttributeNS(null,"selected")&&"null"!==u.getAttributeNS(null,"selected"))break;l++}u=u.nextSibling}e.selectedIndex=t.selectedIndex=l}}function updateAttribute(e,t,u){e[u]!==t[u]&&(t[u]=e[u],e[u]?t.setAttribute(u,""):t.removeAttribute(u,""))}var events=require("./events"),eventsLength=events.length,ELEMENT_NODE=1,TEXT_NODE=3,COMMENT_NODE=8;module.exports=morph},{"./events":2}],4:[function(require,module,exports){module.exports=function e(t,n){for(var o=0;o<n.length;o++){var a=n[o];if(Array.isArray(a))e(t,a);else{if(("number"==typeof a||"boolean"==typeof a||a instanceof Date||a instanceof RegExp)&&(a=a.toString()),"string"==typeof a){if(t.lastChild&&"#text"===t.lastChild.nodeName){t.lastChild.nodeValue+=a;continue}a=document.createTextNode(a)}a&&a.nodeType&&t.appendChild(a)}}}},{}],5:[function(require,module,exports){"use strict";function uuid(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^16*Math.random()>>t/4).toString(16)})}function isElementInContainer(t,e){for(;t&&t!==document;){if(t.getAttribute("id")===e)return!0;t=t.parentNode}return!1}function DPicker(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(this instanceof DPicker))return new DPicker(t,n);var a=this._getContainer(t),i=a.container,r=a.attributes;this._container=uuid(),this._data={};var o={months:moment.months(),days:moment.weekdaysShort(),empty:!1,valid:!0,order:["months","years","time","days"],hideOnDayClick:!0,hideOnEnter:!0,hideOnOutsideClick:!0,siblingMonthDayClick:!1,firstDayOfWeek:moment.localeData().firstDayOfWeek()};for(var d in o)void 0===n[d]?this._data[d]=o[d]:this._data[d]=n[d];this._data.inputName=r.name?r.name:n.inputName?n.inputName:"dpicker-input",this._data.inputId=r.id?r.id:n.inputId?n.inputId:uuid(),this._setData("format",[r.format,"DD/MM/YYYY"]);var s={display:!1,min:moment("1986-01-01"),max:moment().add(1,"year").month(11),format:this._data.format};for(var u in s)void 0!==n[u]&&(s[u]=n[u]);this._events=this._loadEvents(),this._loadModules(r,n),this._createMethods(s,r),void 0!==r.value&&""!==r.value||(this._data.empty=!0),this._setData("model",[r.value,n.model,moment()],!0),this.onChange=n.onChange,document.addEventListener("click",this._events.hide),document.addEventListener("touchend",function(t){e._events.inputBlur(t)}),this.initialize(),this._mount(i),i.id=this._container,i.addEventListener("keydown",this._events.keyDown);var l=i.querySelector("input");return l.addEventListener("blur",this._events.inputBlur),this}var _appendChild=require("yo-yoify/lib/appendChild"),nanomorph=require("nanomorph"),moment=require("moment");DPicker.prototype._setData=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=0;a<e.length;a++)if(void 0!==e[a]&&""!==e[a]){if(n===!1){this._data[t]=e[a];break}if(e[a]instanceof moment&&e[a].isValid()){this._data[t]=e[a];break}this._data[t]=moment();var i=moment(e[a],this._data.format,!0);if(i.isValid()){this._data[t]=i;break}}},DPicker.prototype._createGetSet=function(t){DPicker.prototype.hasOwnProperty(t)||Object.defineProperty(DPicker.prototype,t,{get:function(){return this._data[t]},set:function(e){this._data[t]=e,this.redraw()}})},DPicker.prototype._createMethods=function(t,e){for(var n in t)this._createGetSet(n),this._setData(n,[e[n],t[n]],t[n]instanceof moment)},DPicker.prototype._getContainer=function(t){if("undefined"==typeof t)throw new ReferenceError("Can not initialize DPicker without a container");var e={};if([].slice.call(t.attributes).forEach(function(t){e[t.name]=t.value}),void 0!==t.length&&t[0]&&(t=t[0]),"INPUT"===t.tagName){if(!t.parentNode)throw new ReferenceError("Can not initialize DPicker on an input without parent node");var n=t.parentNode;t.parentNode.removeChild(t),t=n,t.classList.add("dpicker")}return{container:t,attributes:e}},DPicker.prototype._getRenderChild=function(){var t={years:this.renderYears(this._events,this._data),months:this.renderMonths(this._events,this._data)};for(var e in this._modules.render)t[e]=this._modules.render[e](this._events,this._data);return t.days=this.renderDays(this._events,this._data),this._data.order.filter(function(e){return t[e]}).map(function(e){return t[e]})},DPicker.prototype._mount=function(t){this._tree=this.getTree(),t.appendChild(this._tree)},DPicker.prototype._decorate=function(t,e,n){var a=this;return function(){for(var i=a._modules[t][n],r=0;r<i.length;r++)if(i[r].apply(a,arguments)===!1)return!1;return e.apply(a,arguments)}},DPicker.prototype._loadModules=function(t,e){this._modules={calls:{},events:{},render:{}};var n=["events","calls"],a=["initialize","redraw","modelSetter"];for(var i in DPicker.modules){for(var r=DPicker.modules[i],o=0;o<n.length;o++){var d=n[o];for(var s in r[d])if(d!==n[0]||void 0!==this._events[s]){var u=r[d][s];void 0===this._modules[d][s]?this._modules[d][s]=[u]:this._modules[d][s].push(u)}else this._events[s]=r[d][s].bind(this)}if(r.render)for(var l in r.render){if(l in this._modules.render)throw new ReferenceError("Can not override a render method");this._modules.render[l]=r.render[l]}if(r.properties)for(var h in r.properties)if(!this._data[h]){var m=r.properties[h],c="function"==typeof m.attribute?m.attribute(t):t[m.attribute];this._createGetSet(h),this._setData(h,[c,e[h],m["default"]],!!m.isMoment)}}for(var p=0;p<n.length;p++)for(var f=n[p],v=0===p?Object.keys(this._events):a,_=0;_<v.length;_++){var y=v[_];if(void 0!==this._modules[f][y])if(0===p){var g=this._events[y];this._events[y]=this._decorate(f,g,y)}else{var C=this[y];this[y]=this._decorate(f,C,y)}}},DPicker.prototype._loadEvents=function(){var t=this;return{hide:function(e){if(t._data.hideOnOutsideClick!==!1&&t.display!==!1){var n=e.target;isElementInContainer(n.parentNode,t._container)||(t.display=!1,t.onChange(!1))}},inputChange:function(e){if(e.target.value){var n=moment(e.target.value,t._data.format,!0);t.isValid(n)===!0&&(t._data.model=n),t._data.empty=!1}else t._data.empty=!0;t.redraw(),t.onChange({modelChanged:!0,name:"inputChange",event:e})},inputBlur:function(e){if(t.display!==!1){var n=e.relatedTarget||e.target;isElementInContainer(n.parentNode,t._container)||(t.display=!1,t.onChange({modelChanged:!1,name:"inputBlur",event:e}))}},inputFocus:function(e){t.display=!0,e.target&&e.target.select&&e.target.select(),t.onChange({modelChanged:!1,name:"inputFocus",event:e})},yearChange:function(e){t._data.empty=!1,t._data.model.year(e.target.options[e.target.selectedIndex].value),t.isValid(t._data.model),t.redraw(),t.onChange({modelChanged:!0,name:"yearChange",event:e})},monthChange:function(e){t._data.empty=!1,t._data.model.month(e.target.options[e.target.selectedIndex].value),t.isValid(t._data.model),t.redraw(),t.onChange({modelChanged:!0,name:"monthChange",event:e})},dayClick:function(e){e.preventDefault(),e.stopPropagation(),t._data.model.date(e.target.value),t._data.empty=!1,t._data.hideOnDayClick&&(t.display=!1),t.isValid(t._data.model),t.redraw(),t.onChange({modelChanged:!0,name:"dayClick",event:e})},previousMonthDayClick:function(e){t._data.siblingMonthDayClick&&(e.preventDefault(),e.stopPropagation(),t._data.model.date(e.target.value),t._data.model.subtract(1,"month"),t._data.empty=!1,t._data.hideOnDayClick&&(t.display=!1),t.isValid(t._data.model),t.redraw(),t.onChange({modelChanged:!0,name:"previousMonthDayClick",event:e}))},nextMonthDayClick:function(e){t._data.siblingMonthDayClick&&(e.preventDefault(),e.stopPropagation(),t._data.model.date(e.target.value),t._data.model.add(1,"month"),t._data.empty=!1,t._data.hideOnDayClick&&(t.display=!1),t.isValid(t._data.model),t.redraw(),t.onChange({modelChanged:!0,name:"nextMonthDayClick",event:e}))},dayKeyDown:function(){},keyDown:function(e){if(t._data.hideOnEnter){var n=e.which||e.keyCode;13!==n&&27!==n||(document.getElementById(t.inputId).blur(),t.display=!1,t.onChange({modelChanged:!1,name:"keyDown",event:e}))}}}},DPicker.prototype.getTree=function(){return this.renderContainer(this._events,this._data,[this.renderInput(this._events,this._data),this.render(this._events,this._data,this._getRenderChild())])},DPicker.prototype.isValid=function(t){if(!(t instanceof moment&&t.isValid()))return this._data.valid=!1,!1;var e=this.time?"minute":"day";return t.isBefore(this._data.min,e)||t.isAfter(this._data.max,e)?(this._data.valid=!1,!0):(this._data.valid=!0,!0)},DPicker.prototype.renderInput=function(t,e,n){var a;return a=document.createElement("input"),a.setAttribute("id",""+String(e.inputId)),a.setAttribute("value",""+String(e.empty===!0?"":e.model.format(e.format))),a.setAttribute("type","text"),a.setAttribute("min",""+String(e.min.format(e.format))),a.setAttribute("max",""+String(e.max.format(e.format))),a.setAttribute("format",""+String(e.format)),a.onchange=t.inputChange,a.onfocus=t.inputFocus,a.setAttribute("name",""+String(e.inputName)),a.setAttribute("aria-invalid",""+String(e.valid===!1)),a.setAttribute("aria-haspopup","aria-haspopup"),a.setAttribute("class",""+String(e.valid===!1?"dpicker-invalid":"")),a},DPicker.prototype.renderContainer=function(t,e,n){var a;return a=document.createElement("div"),a.setAttribute("class","dpicker"),_appendChild(a,[n]),a},DPicker.prototype.render=function(t,e,n){var a;return a=document.createElement("div"),a.setAttribute("aria-hidden",""+String(e.display===!1)),a.setAttribute("class","dpicker-container "+String(e.display===!0?"dpicker-visible":"dpicker-invisible")),_appendChild(a,[" ",n," "]),a},DPicker.prototype.renderYears=function(t,e,n){for(var a,i=e.model.year(),r=e.max.year()+1,o=e.min.year(),d=[];--r>=o;)if(r===i){var s;d.push((s=document.createElement("option"),s.setAttribute("value",""+String(r)),s.setAttribute("selected","selected"),_appendChild(s,[r]),s))}else{var u;d.push((u=document.createElement("option"),u.setAttribute("value",""+String(r)),_appendChild(u,[r]),u))}return a=document.createElement("select"),a.onchange=t.yearChange,a.setAttribute("name","dpicker-year"),a.setAttribute("aria-label","Year"),_appendChild(a,[d]),a},DPicker.prototype.renderMonths=function(t,e,n){var a,i=e.model.month(),r=e.model.year(),o=e.months,d=e.months.map(function(t,e){return e});if(e.max.year()===r){var s=e.max.month();d=d.filter(function(t){return t<=s})}if(e.min.year()===r){var u=e.min.month();d=d.filter(function(t){return t>=u})}return a=document.createElement("select"),a.onchange=t.monthChange,a.setAttribute("name","dpicker-month"),a.setAttribute("aria-label","Month"),_appendChild(a,[" ",d.map(function(t,e){var n,a;return t===i?(n=document.createElement("option"),n.setAttribute("value",""+String(t)),n.setAttribute("selected","selected"),_appendChild(n,[o[t]]),n):(a=document.createElement("option"),a.setAttribute("value",""+String(t)),_appendChild(a,[o[t]]),a)})," "]),a},DPicker.prototype.renderDays=function(t,e,n){var a,i,r=e.model.daysInMonth(),o=e.model.clone().subtract(1,"months").daysInMonth(),d=e.firstDayOfWeek,s=+e.model.clone().date(1).format("e")-1,u=e.model.date(),l=e.model.month(),h=e.model.year(),m=void 0,c=void 0,p=void 0,f=void 0,v=new Array(7);e.days.map(function(t,e){v[e<d?6-e:e-d]=t}),e.model.isSame(e.min,"month")&&(m=e.min.date(),p=e.min.month()),e.model.isSame(e.max,"month")&&(c=e.max.date(),f=e.max.month());var _=new Array(Math.ceil(.1+(s+r)/7)).fill(0),y=void 0,g=void 0,C=!1,k=!1,D=!0,b="";return i=document.createElement("table"),_appendChild(i,[" ",(a=document.createElement("tr"),_appendChild(a,[v.map(function(t){var e;return e=document.createElement("th"),_appendChild(e,[t]),e})]),a)," ",_.map(function(n,a){var i;return i=document.createElement("tr"),_appendChild(i,[new Array(7).fill(0).map(function(n,i){var d,m,c;g=D,b="",i<=s&&0===a?(y=o-(s-i),g=!1,C=!0):i===s+1&&0===a?(C=!1,y=1,g=!0):(y===r&&(y=0,g=!1,D=!1,k=!0),y++);var p=C?l:k?l+2:l+1,f=moment(y+"-"+p+"-"+h,"DD-MM-YYYY");return g===!1&&e.siblingMonthDayClick===!0&&(g=!0),e.min&&g&&(g=f.isSameOrAfter(e.min,"day")),e.max&&g&&(g=f.isSameOrBefore(e.max,"day")),g===!0&&C===!1&&k===!1&&u===y&&(b="dpicker-active"),d=document.createElement("td"),d.setAttribute("class",""+String(g===!0?"dpicker-active":"dpicker-inactive")),_appendChild(d,[" ",g===!0?(m=document.createElement("button"),m.setAttribute("value",""+String(y)),m.setAttribute("aria-label","Day "+String(y)),m.setAttribute("aria-disabled",""+String(g)),m.onclick=C===!1&&k===!1?t.dayClick:C===!0?t.previousMonthDayClick:t.nextMonthDayClick,m.setAttribute("type","button"),m.onkeydown=t.dayKeyDown,m.setAttribute("class",""+String(b)),_appendChild(m,[" ",y," "]),m):(c=document.createElement("span"),c.setAttribute("class",""+String(b)),_appendChild(c,[y]),c)," "]),d})]),i})," "]),i},DPicker.prototype.initialize=function(){this.isValid(this._data.model)},DPicker.prototype.modelSetter=function(t){this._data.empty=!t,this.isValid(t)===!0&&(this._data.model=t),this.redraw()},DPicker.prototype.redraw=function(){var t=this.getTree();this._tree=nanomorph(this._tree,t)},Object.defineProperties(DPicker.prototype,{container:{get:function(){return this._container}},inputId:{get:function(){return this._data.inputId}},input:{get:function(){return this._data.empty?"":this._data.model.format(this._data.format)}},onChange:{set:function(t){var e=this;this._onChange=function(n){return!!t&&t(e._data,n)}},get:function(){return this._onChange}},valid:{get:function(){return this._data.valid}},model:{set:function(t){this.modelSetter(t)},get:function(){return this._data.model}}}),DPicker.modules={},module.exports=DPicker},{moment:void 0,nanomorph:1,"yo-yoify/lib/appendChild":4}]},{},[5])(5)});
