!function(e,t){"function"==typeof define&&define.amd?define("DPicker.modules.time",["DPicker","moment"],t):"object"==typeof module&&module.exports?module.exports=t(require("dpicker"),require("moment")):e.DPicker.modules.time=t(e.DPicker,e.moment)}(this,function(e,t){"use strict";function n(e){var t=e.meridiem?s:a,n=r.filter(function(t){return t%e.step===0});return[e.min,e.max].map(function(i,r){if(e.model.isSame(i,"day")){var a=+e.meridiem?i.format("h"):i.hours();if(t=t.filter(function(e){return 0===r?e>=a:e<=a}),e.model.isSame(i,"hours")){var s=i.minutes();n=n.filter(function(e){return 0===r?e>=s:e<=a})}}}),{hours:t,minutes:n}}function i(e){return e<10?"0"+e:""+e}if(!e)throw new ReferenceError("DPicker is required for this extension to work");var r=new Array(60).fill(0).map(function(e,t){return t}),a=new Array(24).fill(0).map(function(e,t){return t}),s=new Array(12).fill(0).map(function(e,t){return 0===t?12:t});s.push(s.shift());var u=function(t,r,a){if(!r.time)return e.h("span",{style:"display: none;",class:"dpicker-time"});var s=r.model.hours();r.meridiem&&(s=s>12?s-12:s,s=0===s?12:s);var u=n(r),o=u.hours,m=u.minutes,d=r.model.minutes(),h=[];if(r.concatHoursAndMinutes?h.push(e.h("select",{onchange:t.minuteHoursChange,name:"dpicker-time","aria-label":"Time"},[].concat.apply([],m.map(function(e){return o.map(function(t){return t+":"+e})})).sort(function(e,t){return e=e.split(":").map(parseFloat),t=t.split(":").map(parseFloat),e[0]<t[0]?-1:e[0]>t[0]?1:e[1]<t[1]?-1:e[1]>t[1]?1:0}).map(function(t){return e.h("option",{value:t,selected:t===s+":"+d,key:t},t.split(":").map(i).join(":"))}))):h.push(e.h("select",{onchange:t.hoursChange,name:"dpicker-hours","aria-label":"Hours"},o.map(function(t,n){return e.h("option",{value:t,selected:t===s,key:t},i(t))})),e.h("select",{onchange:t.minutesChange,name:"dpicker-minutes","aria-label":"Minutes"},m.map(function(t){return e.h("option",{value:t,selected:t===d,key:t},i(t))}))),r.meridiem){var l=r.model.format("A");h.push(e.h("select",{onchange:t.meridiemChange,name:"dpicker-meridiem"},["AM","PM"].map(function(t){return e.h("option",{value:t,selected:l===t},t)})))}return e.h("span",{class:"dpicker-time"},h)},o={hoursChange:function(e){this._data.empty=!1;var t=parseInt(e.target.options[e.target.selectedIndex].value,10);this._data.meridiem&&("PM"===this._data.model.format("A")?t=12===t?12:t+12:12===t&&(t=0)),this._data.model.hours(t),this._minutesStep(),this.redraw(["input","container"]),this.onChange()},minutesChange:function(e){this._data.empty=!1,this._data.model.minutes(e.target.options[e.target.selectedIndex].value),this.redraw(["input","container"]),this.onChange()},minuteHoursChange:function(e){var t=e.target.options[e.target.selectedIndex].value.split(":");this._events.hoursChange({target:{options:[{value:t[0]}],selectedIndex:0}}),this._events.minutesChange({target:{options:[{value:t[1]}],selectedIndex:0}})},meridiemChange:function(e){this._data.empty=!1;var t=e.target.options[e.target.selectedIndex].value,n=this._data.model.hours();n="AM"===t?12===n?0:n-12:12===n?12:n+12,this._data.model.hours(n),this.redraw(["input","container"]),this.onChange()},inputChange:function(){this._minutesStep()}},m=e.modules.time={events:o,render:{time:u},properties:{time:{default:!1,attribute:function(e){var t=e.filter(function(e){return"type"===e.name})[0];return!!t&&"datetime"===t.value},getset:!0},meridiem:{default:!1,attribute:"meridiem",getset:!0},step:{default:1,attribute:function(e){var t=e.filter(function(e){return"step"===e.name})[0];return t?parseInt(t.value,10):1},getset:!0}},calls:{_initialize:function(e){this._minutesStep()},_modelSetter:function(e){this._minutesStep()}}};return e.prototype._minutesStep=function(){if(this._data.time){var e=n(this._data),t=(e.hours,e.minutes),i=this._data.model.minutes();if(0===t.length){this._data.min.minutes(0),this._data.min.add(1,"hours");var r=n(this._data);r.hours,r.minutes}return this._data.model.minutes()<t[0]&&(this._data.model.minutes(t[0]),i=t[0]),i>t[t.length-1]?(this._data.model.minutes(0),void this._data.model.add(1,"hours")):void(this._data.step<=1||(t[t.length]=60,i=t.reduce(function(e,t){return Math.abs(t-i)<Math.abs(e-i)?t:e}),t.length--,this._data.model.minutes(i)))}},m});